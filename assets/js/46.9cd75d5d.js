(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{510:function(a,s,t){"use strict";t.r(s);var n=t(9),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"apache-cassandra-分布式-k-v-存储方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#apache-cassandra-分布式-k-v-存储方案"}},[a._v("#")]),a._v(" Apache Cassandra 分布式 K/V 存储方案")]),a._v(" "),s("div",{staticClass:"custom-block note"},[s("p",{staticClass:"custom-block-title"},[a._v("开源网址")]),a._v(" "),s("p",[a._v("官网：https://cassandra.apache.org/")]),a._v(" "),s("p",[a._v("github：https://github.com/apolloconfig/apollo")])]),a._v(" "),s("h2",{attrs:{id:"简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[a._v("#")]),a._v(" 简介")]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/docker/cassandra.svg",alt:"img"}})]),a._v(" "),s("blockquote",[s("p",[a._v("Apache Cassandra 是一套开源分布式 Key-Value 存储系统。它最初由 Facebook 开发，用于储存特别大的数据。")])]),a._v(" "),s("p",[a._v("主要特性：")]),a._v(" "),s("ul",[s("li",[a._v("分布式")]),a._v(" "),s("li",[a._v("基于 column 的结构化")]),a._v(" "),s("li",[a._v("高伸展性")])]),a._v(" "),s("p",[a._v("Cassandra 的主要特点就是它不是一个数据库，而是由一堆数据库节点共同构成的一个分布式网络服务，对 Cassandra 的一个写操作，会被复制到其他节点上去，对 Cassandra 的读操作，也会被路由到某个节点上面去读取。对于一个 Cassandra 群集来说，扩展性能 是比较简单的事情，只管在群集里面添加节点就可以了。")]),a._v(" "),s("p",[a._v("Cassandra 是一个混合型的非关系的数据库，类似于 Google 的 BigTable。其主要功能比 Dynomite（分布式的 Key-Value 存 储系统）更丰富，但支持度却不如文档存储 MongoDB（介于关系数据库和非关系数据库之间的开源产品，是非关系数据库当中功能最丰富，最像关系数据库 的。支持的数据结构非常松散，是类似 json 的 bjson 格式，因此可以存储比较复杂的数据类型。）Cassandra 最初由 Facebook 开发，后转变成了开源项目。它是一个网络社交云计算方面理想的数据库。以 Amazon 专有的完全分布式的 Dynamo 为基础，结合了 Google BigTable 基于列族（Column Family）的数据模型。P2P 去中心化的存储。很多方面都可以称之为 Dynamo 2.0。")]),a._v(" "),s("p",[a._v("和其他数据库比较，有几个突出特点：")]),a._v(" "),s("ul",[s("li",[a._v("模式灵活 ：使用 Cassandra，像文档存储，你不必提前解决记录中的字段。你可以在系统运行时随意的添加或移除字段。这是一个惊人的效率提升，特别是在大型部 署上。")]),a._v(" "),s("li",[a._v("真正的可扩展性 ：Cassandra 是纯粹意义上的水平扩展。为给集群添加更多容量，可以指向另一台电脑。你不必重启任何进程，改变应用查询，或手动迁移任何数据。")]),a._v(" "),s("li",[a._v("多数据中心识别 ：你可以调整你的节点布局来避免某一个数据中心起火，一个备用的数据中心将至少有每条记录的完全复制。")])]),a._v(" "),s("p",[a._v("一些使 Cassandra 提高竞争力的其他功能：")]),a._v(" "),s("ul",[s("li",[a._v("范围查询 ：如果你不喜欢全部的键值查询，则可以设置键的范围来查询。")]),a._v(" "),s("li",[a._v("列表数据结构 ：在混合模式可以将超级列添加到 5 维。对于每个用户的索引，这是非常方便的。")]),a._v(" "),s("li",[a._v("分布式写操作 ：有可以在任何地方任何时间集中读或写任何数据。并且不会有任何单点失败。")])]),a._v(" "),s("h2",{attrs:{id:"docker-compose-yml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml"}},[a._v("#")]),a._v(" docker-compose.yml")]),a._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("version")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'3.7'")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 3 node cluster")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# If you see exit code 137 (OOM killer) then ensure Docker has access to more resources")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("services")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cassandra1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3.11.4\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("TZ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Asia/Shanghai\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ports")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" 9042"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9042")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Native transport")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" 7199"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7199")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# JMX")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" 9160"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9160")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Thrift clients")]),a._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cassandra2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3.11.4\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra2\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" /bin/bash "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("c \"echo 'Waiting for seed node' "),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&&")]),a._v(" sleep 30 "),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&&")]),a._v(" /docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("entrypoint.sh cassandra "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v('f"\n    '),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("TZ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Asia/Shanghai\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("CASSANDRA_SEEDS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("depends_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cassandra1"')]),a._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# you cannot have multiple nodes join the cluster at the same time when")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cassandra.consistent.rangemovement is true so we further delay it to give it time to stabilize")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cassandra3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3.11.4\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("container_name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra3\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("restart")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" always\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("command")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" /bin/bash "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("c \"echo 'Waiting for seed node' "),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&&")]),a._v(" sleep 80 "),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&&")]),a._v(" /docker"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("entrypoint.sh cassandra "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v('f"\n    '),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("environment")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("TZ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" Asia/Shanghai\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("CASSANDRA_SEEDS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" cassandra1\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("depends_on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cassandra1"')]),a._v("\n")])])]),s("h2",{attrs:{id:"deploy-sh"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy-sh"}},[a._v("#")]),a._v(" deploy.sh")]),a._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#!\\bin\\bash")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker-compose")]),a._v(" up "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);